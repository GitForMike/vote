(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6898:(e,t,s)=>{Promise.resolve().then(s.bind(s,8856))},8856:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(5155),r=s(2115),l=s(8915);let i=()=>{{let e=localStorage.getItem("voteCount");return e?parseInt(e,10):0}},n=e=>{localStorage.setItem("voteCount",e.toString())},o=()=>{{let e=localStorage.getItem("lastVoteDate"),t=new Date().toISOString().split("T")[0];if(e!==t)return localStorage.setItem("lastVoteDate",t),n(0),!0}return!1};var c=s(6874),d=s.n(c);function x(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(!0),[x,g]=(0,r.useState)(!1),[m,h]=(0,r.useState)(0),[u,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=(await (0,l.TO)()).sort((e,t)=>t.votes-e.votes);t(e)}catch(e){console.error("Error fetching singers:",e)}finally{c(!1)}})();let e=i();h(e),o()&&(n(3),h(3),e=3),v(e<=0)},[]);let b=async e=>{x||m<=0||(g(!0),t(t=>t.map(t=>t.id===e?{...t,votes:t.votes+1}:t)),await (0,l.kx)(e),n(m-1),h(e=>e-1),g(!1),v(m-1<=0))};return(0,a.jsxs)("div",{className:"min-h-screen bg-white py-10 px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-12",children:"트로트 가수 투표"}),u&&(0,a.jsx)("div",{className:"text-center text-xl text-red-600 mb-4",children:"하루에 3번만 투표할 수 있습니다. 남은 횟수: 0"}),m>0&&!u&&(0,a.jsxs)("div",{className:"text-center text-xl text-gray-600 mb-6",children:["남은 투표 횟수: ",m," / 3"]}),(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)(d(),{href:"/register",children:(0,a.jsx)("button",{className:"bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-400 transition-colors",children:"신규 가수 등록하기"})})}),s?(0,a.jsx)("div",{className:"text-center text-xl text-gray-600",children:"Loading..."}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-200 hover:shadow-xl transition-shadow",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-center text-gray-700 mb-4",children:e.name}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-xl text-gray-600 mb-4",children:["Votes: ",e.votes]}),(0,a.jsx)("button",{onClick:()=>b(e.id),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-400 disabled:bg-gray-300 transition-colors",disabled:x||m<=0,children:x?"투표 중...":"투표하기"})]})]},e.id))})]})}},8915:(e,t,s)=>{"use strict";s.d(t,{TO:()=>n,k8:()=>c,kx:()=>o});var a=s(3915),r=s(5317);let l=(0,a.Wp)({apiKey:"AIzaSyDDgwWw7xHv3QXUfQ3NeRMKeslliq-_LJ4",authDomain:"voting-59a7a.firebaseapp.com",projectId:"voting-59a7a",storageBucket:"voting-59a7a.firebasestorage.app",messagingSenderId:"706916625333",appId:"1:706916625333:web:9e50ed99ccef65241587fc",measurementId:"G-J9RY10WG3P"}),i=(0,r.aU)(l),n=async()=>{let e=(0,r.rJ)(i,"singers");return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},o=async e=>{let t=(0,r.H9)(i,"singers",e),s=await (0,r.x7)(t);if(s.exists()){let e=s.data().votes+1;await (0,r.mZ)(t,{votes:e})}else console.error("가수를 찾을 수 없습니다.")},c=async e=>{let t=(0,r.H9)(i,"singers",e);await (0,r.BN)(t,{name:e,votes:0})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,298,441,684,358],()=>t(6898)),_N_E=e.O()}]);